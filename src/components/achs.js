import{D}from"../utils/break_eternity.js";import{notify}from"../utils/notify.js";import{player}from"../player.js";import{DATA}from"../tmp.js";import{getUpgrade}from"./buyables.js";import{setupVue}from"../setup.js";import{TABS}from"./tabs.js";import{layerGot}from"./layer.js";import{format}from"../utils/format.js";export class Achievement{constructor({id:e,title:i,progress:t,condition:n,conditionText:o,hyperCondition:r,hyperConditionText:s,onGive:h}){this.id=e,this.title=i,this.progress=t,this.condition=n,t&&(this._condition=n,this.condition=()=>D(t()).div(n())),this.conditionText=o,this.hyperCondition=r,r&&t&&(this._hyperCondition=r,this.hyperCondition=()=>D(t()).div(r())),this.hyperConditionText=s,this.onGive=h??function(){},ACH_ROWS=Math.max(ACH_ROWS,Math.ceil(e/10))}has(){return player.ach.includes(this.id)}hyperHas(){return player.hyperAch.includes(this.id)}give(e=!1,i=!1){this.hyperHas()||((i||Number(this.hyperCondition?.())>=1)&&(notify("Achievement hyperfied! "+this.title),player.hyperAch.push(this.id)),this.has()||!e&&Number(this.condition())<1||(notify("Achievement got! "+this.title),player.ach.push(this.id),this.onGive()))}}let ACH_ROWS=0,ACH_LIST=[new Achievement({id:0,title:"Welcome!",progress:()=>player.stats.time/60,condition:()=>0,conditionText:"Start this game.",hyperCondition:()=>45,hyperConditionText:"Play this game for 45 minutes."}),new Achievement({id:1,title:"Your First Gem!",condition:()=>DATA.resources.bronze.amt.value.div(1),conditionText:"Obtain 1 Bronze.",hyperCondition:()=>DATA.resources.platinum.amt.value.div(1),hyperConditionText:"Obtain 1 Platinum."}),new Achievement({id:2,title:"Digging the Surface",progress:()=>player.quarry.depth,condition:()=>5,conditionText:"Reach Quarry Depth 5.",hyperCondition:()=>80,hyperConditionText:"Reach Quarry Depth 80."}),new Achievement({id:3,title:"Upgraded",progress:()=>getUpgrade("GreenPapers",0).amt,condition:()=>1,conditionText:"Spend your first Green Papers for an Upgrade.",hyperCondition:()=>50,hyperConditionText:"Fully upgrade your first Upgrade."}),new Achievement({id:4,title:"Money Bag",progress:()=>DATA.resources.greenPaper.amt.value,condition:()=>1e3,conditionText:"Get 1,000 Green Papers.",hyperCondition:()=>1e30,hyperConditionText:"Get 1.00 N Green Papers."}),new Achievement({id:5,title:"Treasure Hunter!",tooltip:"Obtain a Treasure.",progress:()=>player.stats.treasures,condition:()=>1,conditionText:"Obtain a Treasure.",hyperCondition:()=>25,hyperConditionText:"Obtain 25 Treasures."}),new Achievement({id:6,title:"Hard Hitter",progress:()=>player.stats.hits,condition:()=>1e4,conditionText:"Hit 10,000 Blocks.",hyperCondition:()=>25e4,hyperConditionText:"Hit 250,000 Blocks."}),new Achievement({id:7,title:"Map Clear",progress:()=>player.stats.mapRows,condition:()=>1,conditionText:"Clear a Row in a Map.",hyperCondition:()=>250,hyperConditionText:"Clear 250 Rows in a Map."}),new Achievement({id:8,title:"Millionaire",progress:()=>DATA.resources.greenPaper.amt.value,condition:()=>1e6,conditionText:"Get 1.00 M Green Papers.",hyperCondition:()=>1e60,hyperConditionText:"Get 1.00e60 Green Papers."}),new Achievement({id:9,title:"Billionaire",progress:()=>DATA.resources.greenPaper.amt.value,condition:()=>1e9,conditionText:"Get 1.00 B Green Papers.",hyperCondition:()=>1e90,hyperConditionText:"Get 1.00e90 Green Papers."}),new Achievement({id:10,title:"Into the Deep",progress:()=>D(0),condition:()=>1,conditionText:"Collapse.",hyperCondition:()=>5,hyperConditionText:"Collapse 5 times."}),new Achievement({id:11,title:"Miner Production!",condition:()=>!1,conditionText:"Get your first Recruiter / Miner Miner."}),new Achievement({id:12,title:"???",condition:()=>!1,conditionText:"???"}),new Achievement({id:13,title:"Real Treasures",condition:()=>!1,conditionText:"Get your first Artifact."}),new Achievement({id:14,title:"???",condition:()=>!1,conditionText:"???"}),new Achievement({id:15,title:"???",condition:()=>!1,conditionText:"???"}),new Achievement({id:16,title:"Consumed.",progress:()=>D(player.quarry.depth),condition:()=>200,conditionText:"Reach the Dark Dimension.",hyperCondition:()=>300,hyperConditionText:"Reach Quarry Depth 300."}),new Achievement({id:17,title:"Dark Mana",condition:()=>!1,conditionText:"Get ??? Dark Energy."}),new Achievement({id:18,title:"Tone Up To 11!",condition:()=>!1,conditionText:"Get 11 Dark Tonings."}),new Achievement({id:19,title:"???",condition:()=>!1,conditionText:"???"})];export function achInterval(){for(const e of ACH_LIST)e.give()}TABS.Achievements={component:{template:'<div>\n      Achievements: {{ACH_GOT}} / {{ACH_COUNT}} ({{(ACH_GOT / ACH_COUNT * 100).toFixed(2)}}%)<br/>\n      Hyperfied: {{HYPER_GOT}} / {{HYPER_COUNT}} ({{(HYPER_GOT / HYPER_COUNT * 100).toFixed(2)}}%)\n      <br/><br/>\n      <table>\n        <tr v-for="row in ACH_ROWS">\n          <td v-for="col in 10">\n            <ach :ach-id="(row - 1) * 10 + (col - 1)"/>\n          </td>\n        </tr>\n      </table>\n    </div>',setup:()=>({ACH_ROWS:ACH_ROWS,ACH_COUNT:ACH_LIST.length,ACH_GOT:player.ach.length,HYPER_COUNT:ACH_LIST.filter((e=>e.hyperCondition)).length,HYPER_GOT:player.hyperAch.length})}},setupVue.ach={props:["achId"],computed:{completed(){return this.ach.has()},hyperfied(){return this.ach.hyperHas()},progress(){return D(this.ach.progress?.())},condition(){return D(this.ach.progress?this.ach._condition():this.ach.condition())},hyperCondition(){return D(this.ach.progress?this.ach._hyperCondition?.():this.ach.hyperCondition?.())},percent(){return Number(this.completed?this.ach.hyperCondition?.():this.ach.condition())||0}},template:'<div v-if="ach"\n    :class="{\n      ach: true,\n      tooltip: true,\n      incomplete: !completed, \n      completed: completed && !hyperfied,\n      hyper: hyperfied\n    }"\n    :style="{\n      \'--progress\': percent * 100 + \'%\'\n    }"\n  >\n    {{ach.title}}\n    <span class="tooltiptext">\n      <h1>\n        Condition\n      </h1>\n      {{ach.conditionText}}\n      <i v-if="completed"><br>(Completed)</i>\n      <i v-else-if="ach.progress"><br>({{format(progress, 0)}} / {{format(condition, 0)}})</i>\n      <i v-else-if="condition > 0"><br>({{format(condition * 100)}}%)</i>\n      <template v-if="completed && ach.hyperCondition">\n        <h1>\n          Hyper Condition\n        </h1>\n        {{ach.hyperConditionText}}\n        <i v-if="hyperfied"><br>(Completed)</i>\n        <i v-else-if="ach.progress"><br>({{format(progress, 0)}} / {{format(hyperCondition, 0)}})</i>\n        <i v-else-if="hyperCondition > 0"><br>({{format(hyperCondition * 100)}}%)</i>\n      </template>\n    </span>\n  </div>',setup:e=>({ach:ACH_LIST[e.achId],format:format})};
