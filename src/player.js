import{reactive}from"https://unpkg.com/vue@3.2.37/dist/vue.esm-browser.js";import{app}from"./index.js";import{setupVue}from"./setup.js";import{DATA,setupData,TICK_DATA}from"./tmp.js";import{load,hardReset,save}from"./utils/saveload.js";import{ver}from"./utils/version.js";import{initTabs}from"./components/tabs.js";import{RESOURCES}from"./components/resources.js";import{achInterval}from"./components/achs.js";import{isDev}from"./dev.js";import{initQuarry,getQuarryDepth}from"./features/0-quarry/quarry.js";import{tickNews}from"./components/news-ticker.js";import Decimal from"./utils/break_eternity.js";export const player=reactive(setupPlayer());isDev&&(window.player=player,window.DATA=DATA,window.ver=ver);export function setupPlayer(){return{gp:{upg:{}},inventory:{map:[]},miners:{amt:{},used:{},manualCooldown:0},quarry:initQuarry(),ver:ver,lastTick:Date.now(),ach:[],hyperAch:[],stats:{time:0,max:0,history:[],hits:0,mined:0,treasures:0,mapRows:new Decimal(0)},options:{off:!0,news:!0,icons:""}}}export function gameEnded(){return getQuarryDepth().gte(100)}export function fixPlayer(e){}export let interval;export function loadGame(){initTabs(),setupData(),load(),fixPlayer(player),app.mount("#app"),interval=setInterval(runGame,50),setInterval(achInterval,1e3),setInterval(tickNews,50)}export function runGame(){const e=(Date.now()-player.lastTick)/1e3;player.lastTick=Date.now(),player.stats.max=DATA.resources.greenPaper.amt.value.max(player.stats.max),player.stats.time+=e;for(const t of Object.values(TICK_DATA))t(e);for(let[t,r]of Object.entries(RESOURCES))r.add(DATA.resources[t].prod.value.mul(e));tickNews()}setupVue.end={template:'<div>\n    <h1>Congratulations! You have reached the end!</h1><br />\n\n    <b style="color: gold">The long hike is over. If you didn\'t use a guide, you are a no-lifer.</b><br />\n    You\'ve beaten the game... for now, at least.<br>\n    Check the Discord server to see if there are more updates!<br>\n    <button href="https://discord.gg/fcEXYjPQ43" target="_blank">Discord</button>\n    \n    <button @click="hardReset()">Play Again</button>\n    <button @click="player.won = true">Keep Going</button>\n  </div>',setup:()=>({player:player,hardReset:hardReset})},document.addEventListener("keydown",(function(e){(window.navigator.platform.match("Mac")?e.metaKey:e.ctrlKey)&&83===e.keyCode&&(e.preventDefault(),save(!0))}),!1);
